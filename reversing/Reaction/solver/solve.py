from ptrlib import *
import os

HOST = os.getenv("SECCON_HOST", "localhost")
PORT = int(os.getenv("SECCON_PORT", "5000"))

def drop(offset, direction):
    sock.recvonce(2)
    sock.send(bytes([offset, direction]))
    #print(sock.recvuntil(b"+\n").decode())

#sock = Process("./chemic")
sock = Socket(HOST, PORT)

drop(13, 0)
drop(11, 3)
drop(9, 3)
drop(7, 1)
drop(5, 1)
drop(12, 0)
drop(5, 1)
drop(8, 0)
drop(3, 0)
drop(13, 2)
drop(2, 3)
drop(9, 1)
drop(9, 3)
drop(4, 3)
drop(13, 2)
drop(12, 3)
drop(11, 0)
drop(9, 0)
drop(11, 0)
drop(12, 0)

drop(0, 1)
drop(0, 1)
drop(0, 1)
drop(6, 3)
drop(10, 0)
drop(6, 1)

drop(0, 1)
drop(6, 0)
drop(7, 2)
drop(8, 0)
drop(4, 0)
drop(5, 0)
drop(1, 1)
drop(6, 0)
drop(4, 0)
drop(3, 3)
drop(2, 1)

drop(0, 0)
drop(4, 0)
drop(4, 2)
drop(0, 0)
drop(2, 0)
drop(1, 0)

drop(0, 0)
drop(0, 0)
drop(0, 0)
drop(0, 0)
drop(1, 0)
drop(1, 0)
drop(1, 0)
drop(1, 0)
drop(2, 0)
drop(2, 0)
drop(2, 0)
drop(2, 0)
drop(3, 0)
drop(3, 0)
drop(13, 2)

drop(0xff, 0xff)

print(sock.recvlineafter("FLAG: "))

sock.close()
